import numpy as np

def cd4_progression(x, t):
#   cd4_above_500   = x[0]
#   cd4_350_500     = x[1]
#   cd4_250_349     = x[2]
#   cd4_200_249     = x[3]
#   cd4_100_199     = x[4]
#   cd4_50_99       = x[5]
#   cd4_below_50    = x[6]
#   dead            = x[7]

    A_progression = np.matrix([
        [-0.14,  0.00,  0.00,  0.00,  0.00,  0.00, 0, 0],
        [ 0.14, -0.21,  0.00,  0.00,  0.00,  0.00, 0, 0],
        [ 0.00,  0.21, -0.36,  0.00,  0.00,  0.00, 0, 0],
        [ 0.00,  0.00,  0.36, -0.66,  0.00,  0.00, 0, 0],
        [ 0.00,  0.00,  0.00,  0.66, -0.47,  0.00, 0, 0],
        [ 0.00,  0.00,  0.00,  0.00,  0.47, -0.77, 0, 0],
        [ 0.00,  0.00,  0.00,  0.00,  0.00,  0.77, 0, 0],
        [ 0.00,  0.00,  0.00,  0.00,  0.00,  0.00, 0, 0]
    ])

    A_mort = np.matrix([
        [-0.004,  0.000,  0.000,  0.000,  0.000,  0.000,  0.000, 0],
        [ 0.000, -0.010,  0.000,  0.000,  0.000,  0.000,  0.000, 0],
        [ 0.000,  0.000, -0.026,  0.000,  0.000,  0.000,  0.000, 0],
        [ 0.000,  0.000,  0.000, -0.069,  0.000,  0.000,  0.000, 0],
        [ 0.000,  0.000,  0.000,  0.000, -0.185,  0.000,  0.000, 0],
        [ 0.000,  0.000,  0.000,  0.000,  0.000, -0.500,  0.000, 0],
        [ 0.000,  0.000,  0.000,  0.000,  0.000,  0.000, -1.342, 0],
        [ 0.004,  0.010,  0.026,  0.069,  0.185,  0.500,  1.342, 0]
    ])

    return np.dot( (A_progression + A_mort), x).A.squeeze()
